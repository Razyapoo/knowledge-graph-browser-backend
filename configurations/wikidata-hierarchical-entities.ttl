@prefix browser: <https://linked.opendata.cz/ontology/knowledge-graph-browser/> .
@prefix wdab: <https://linked.opendata.cz/resource/vocabulary/knowledge-graph-browser/wikidata/hierarchical-entities/> .

@prefix dct: <http://purl.org/dc/terms/> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix void: <http://rdfs.org/ns/void#> .

#####################################
# Configurations
#####################################

#####################################
# ViewSets
#####################################

#####################################
# Views
#####################################

<https://linked.opendata.cz/resource/knowledge-graph-browser/view/wikidata/hierarchical-entities/hierarchical-entity/has-parts> a browser:View ;
  dct:title "Složená entita"@cs ;
  dct:description "Pohled na entitu s podřazenými entitami."@cs ;
  browser:hasExpansion <https://linked.opendata.cz/resource/knowledge-graph-browser/expansion-query/wikidata/hierarchical-entities/hierarchical-entity/has-parts> ;
  browser:hasPreview <https://linked.opendata.cz/resource/knowledge-graph-browser/preview-query/wikidata/hierarchical-entities/hierarchical-entity> ;
  browser:hasDetail <https://linked.opendata.cz/resource/knowledge-graph-browser/detail-query/wikidata/hierarchical-entities/hierarchical-entity> .

<https://linked.opendata.cz/resource/knowledge-graph-browser/view/wikidata/hierarchical-entities/hierarchical-entity/part-of> a browser:View ;
  dct:title "Podřazená entita"@cs ;
  dct:description "Pohled na entitu s entitami, kterým je podřazena."@cs ;
  browser:hasExpansion <https://linked.opendata.cz/resource/knowledge-graph-browser/expansion-query/wikidata/hierarchical-entities/hierarchical-entity/part-of> ;
  browser:hasPreview <https://linked.opendata.cz/resource/knowledge-graph-browser/preview-query/wikidata/hierarchical-entities/hierarchical-entity> ;
  browser:hasDetail <https://linked.opendata.cz/resource/knowledge-graph-browser/detail-query/wikidata/hierarchical-entities/hierarchical-entity> .

#####################################
# Queries
#####################################

<https://linked.opendata.cz/resource/knowledge-graph-browser/expansion-query/wikidata/hierarchical-entities/hierarchical-entity/has-parts> a browser:ExpansionQuery ;
  dct:title "Podřazené entity" ;
  browser:hasDataset <https://linked.opendata.cz/resource/knowledge-graph-browser/dataset/wikidata> ;
  browser:query """PREFIX wd: <http://www.wikidata.org/entity/>
PREFIX wdt: <http://www.wikidata.org/prop/direct/>
PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX wdab: <https://linked.opendata.cz/resource/vocabulary/knowledge-graph-browser/wikidata/hierarchical-entities/>
PREFIX browser: <https://linked.opendata.cz/ontology/knowledge-graph-browser/>
CONSTRUCT {  
  ?part a wdab:entity ;
    rdfs:label ?partLabel ;
    browser:class "entity" .
    
  ?node wdab:narrower ?part .
  wdab:narrower browser:class "part" .  
} WHERE {

  {
    ?part wdt:P361 ?node .
  } UNION {
    ?part wdt:P279 ?node .
  }

  SERVICE wikibase:label { bd:serviceParam wikibase:language "cs,en". }
  
}""" .

<https://linked.opendata.cz/resource/knowledge-graph-browser/expansion-query/wikidata/hierarchical-entities/hierarchical-entity/part-of> a browser:ExpansionQuery ;
  dct:title "Nadřazené věci" ;
  browser:hasDataset <https://linked.opendata.cz/resource/knowledge-graph-browser/dataset/wikidata> ;
  browser:query """PREFIX wd: <http://www.wikidata.org/entity/>
PREFIX wdt: <http://www.wikidata.org/prop/direct/>
PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX wdab: <https://linked.opendata.cz/resource/vocabulary/knowledge-graph-browser/wikidata/hierarchical-entities/>
PREFIX browser: <https://linked.opendata.cz/ontology/knowledge-graph-browser/>
CONSTRUCT {  
  ?composite a wdab:entity ;
    rdfs:label ?compositeLabel ;
    browser:class "entity" .
    
  ?composite wdab:narrower ?node .
  wdab:narrower browser:class "part" .  
} WHERE {

  {
    ?node wdt:P361 ?composite .
  } UNION {
    ?node wdt:P279 ?composite .
  }

  SERVICE wikibase:label { bd:serviceParam wikibase:language "cs,en". }
  
}""" .

<https://linked.opendata.cz/resource/knowledge-graph-browser/preview-query/wikidata/hierarchical-entities/hierarchical-entity> a browser:PreviewQuery ;
  dct:title "Přehled hierarchické věci" ;
  browser:hasDataset <https://linked.opendata.cz/resource/knowledge-graph-browser/dataset/wikidata> ;
  browser:query """PREFIX wd: <http://www.wikidata.org/entity/>
PREFIX wdt: <http://www.wikidata.org/prop/direct/>
PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX wdab: <https://linked.opendata.cz/resource/vocabulary/knowledge-graph-browser/wikidata/hierarchical-entities/>
PREFIX browser: <https://linked.opendata.cz/ontology/knowledge-graph-browser/>
CONSTRUCT {
  ?node a wdab:entity ;
    rdfs:label ?nodeLabel ;
    browser:class "entity" .  
} WHERE {
  
  BIND(COALESCE(?type, wdab:entity) AS ?finalType)
  BIND(COALESCE(?class, "entity") AS ?finalClass)
  
  SERVICE wikibase:label { bd:serviceParam wikibase:language "cs,en". } 
  
}""" .

<https://linked.opendata.cz/resource/knowledge-graph-browser/detail-query/wikidata/hierarchical-entities/hierarchical-entity> a browser:DetailQuery ;
  dct:title "Detail hierarchické entity" ;
  browser:hasDataset <https://linked.opendata.cz/resource/knowledge-graph-browser/dataset/wikidata> ;
  browser:query """PREFIX wd: <http://www.wikidata.org/entity/>
PREFIX wdt: <http://www.wikidata.org/prop/direct/>
PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX dct: <http://purl.org/dc/terms/>
PREFIX schema: <http://schema.org/>
PREFIX wdab: <https://linked.opendata.cz/resource/vocabulary/knowledge-graph-browser/wikidata/hierarchical-entities/>
PREFIX browser: <https://linked.opendata.cz/ontology/knowledge-graph-browser/>
CONSTRUCT {
  ?node rdfs:label ?nodeLabel ;
    dct:description ?description ;
    wdt:P18 ?p18 .
} WHERE {
  OPTIONAL {
    ?node schema:description ?description .
    FILTER (LANG(?description) = "cs" || LANG(?description) = "en")
  }
  OPTIONAL {
    ?node wdt:P18 ?p18 .
  }
  SERVICE wikibase:label { bd:serviceParam wikibase:language "cs,en". } 
}""" .

#####################################
# Datasets
#####################################

<https://linked.opendata.cz/resource/knowledge-graph-browser/dataset/wikidata> a void:Dataset ;
  dct:title "Wikidata SPARQL endpoint" ;
  void:sparqlEndpoint <https://query.wikidata.org/sparql> ;
  browser:accept "application/sparql-results+json" .

#####################################
# View vocabularies
#####################################

<https://linked.opendata.cz/resource/vocabulary/knowledge-graph-browser/wikidata/hierarchical-entities/narrower> a owl:ObjectProperty ;
  rdfs:label "podřazeno"@cs ;
  rdfs:comment "věc, která je věci podřazena"@cs ;
  rdfs:domain wdab:entity ;
  rdfs:range wdab:entity . 

#####################################
# Visual styles
#####################################