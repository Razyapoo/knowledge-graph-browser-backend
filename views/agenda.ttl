@prefix view: <https://linked.opendata.cz/ontology/view#> .
@prefix dct: <http://purl.org/dc/terms/> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix l: <https://slovník.gov.cz/legislativní/sbírka/111/2009/pojem/> .
@prefix a: <https://slovník.gov.cz/agendový/104/pojem/> .


<https://martin.necasky.solid.community/profile/kgbrowser/configuration/agenda> a view:Configuration ;
  dct:title "Pohledy na agendy"@cs ;
  view:endpointurl "http://rpp-opendata.egon.gov.cz/odrpp/sparql" ;
  view:condition """PREFIX l: <https://slovník.gov.cz/legislativní/sbírka/111/2009/pojem/> 
PREFIX a: <https://slovník.gov.cz/agendový/104/pojem/>
ASK {
  ?node a l:agenda .    
}"""; 
  view:hasView <https://martin.necasky.solid.community/profile/kgbrowser/views/agenda1>, <https://martin.necasky.solid.community/profile/kgbrowser/views/agenda2> . 

<https://martin.necasky.solid.community/profile/kgbrowser/views/agenda1> a view:View ;
  dct:title "Agenda se svými ohlašovateli a vykonavateli"@cs ;
  view:endpointurl "http://rpp-opendata.egon.gov.cz/odrpp/sparql" ;
  view:expansion """PREFIX l: <https://slovník.gov.cz/legislativní/sbírka/111/2009/pojem/> 
PREFIX a: <https://slovník.gov.cz/agendový/104/pojem/>

CONSTRUCT {
  ?ohlasovatel l:ohlašuje-agendu ?node .
  
  ?vykonavatel l:vykonává-agendu ?node .
} WHERE {  
  ?ohlasovatel l:ohlašuje-agendu ?node .
  
  ?vykonavatel l:vykonává-agendu ?node . 
}""" ;
  view:preview """PREFIX l: <https://slovník.gov.cz/legislativní/sbírka/111/2009/pojem/> 
PREFIX a: <https://slovník.gov.cz/agendový/104/pojem/>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

CONSTRUCT {
  ?node a l:agenda ;
    rdfs:label ?label .
} WHERE {
  ?node l:má-název-agendy ?nazev ; 
    l:má-kód-agendy ?kod .
  FILTER (LANG(?nazev) = "cs")
  
  BIND(CONCAT(?kod, " - ", ?nazev) AS ?label) 
}""" ;
  view:detail """PREFIX l: <https://slovník.gov.cz/legislativní/sbírka/111/2009/pojem/> 
PREFIX a: <https://slovník.gov.cz/agendový/104/pojem/>
PREFIX v: <https://martin.necasky.solid.community/profile/kgbrowser/vocabulary/>

SELECT {
  ?node l:má-název-agendy ?nazev ;
    l:má-kód-agendy ?kod ;
    v:má-počet-vykonavatelů ?pocetVykonavatelu .
} WHERE {
  ?node l:má-název-agendy ?nazev ; 
    l:má-kód-agendy ?kod .
  FILTER (LANG(?nazev) = "cs")

  {
    SELECT (COUNT(*) AS ?pocetVykonavatelu)
    WHERE {
      ?vykonavatel l:vykonává-agendu ?node .
    }
  }   
}""" .


<https://martin.necasky.solid.community/profile/kgbrowser/views/agenda2> a view:View ;
  dct:title "Agenda a činnosti v ní vykonávané"@cs ;
  view:endpointurl "http://rpp-opendata.egon.gov.cz/odrpp/sparql" ;
  view:expansion """PREFIX l: <https://slovník.gov.cz/legislativní/sbírka/111/2009/pojem/> 
PREFIX a: <https://slovník.gov.cz/agendový/104/pojem/>

CONSTRUCT {
  ?cinnost l:je-vykonávána-v-agendě ?node .
} WHERE {
  ?cinnost l:je-vykonávána-v-agendě ?node .
}""" ;
  view:preview """PREFIX l: <https://slovník.gov.cz/legislativní/sbírka/111/2009/pojem/> 
PREFIX a: <https://slovník.gov.cz/agendový/104/pojem/>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

CONSTRUCT {
  ?node a l:agenda ;
    rdfs:label ?label .
} WHERE {
  ?node l:má-název-agendy ?nazev ; 
    l:má-kód-agendy ?kod .
  FILTER (LANG(?nazev) = "cs")
  
  BIND(CONCAT(?kod, " - ", ?nazev) AS ?label) 
}""" ;
  view:detail """PREFIX l: <https://slovník.gov.cz/legislativní/sbírka/111/2009/pojem/> 
PREFIX a: <https://slovník.gov.cz/agendový/104/pojem/>
PREFIX v: <https://martin.necasky.solid.community/profile/kgbrowser/vocabulary/>

CONSTRUCT {
  ?node l:má-název-agendy ?nazev ;
    l:má-kód-agendy ?kod ;
    v:má-počet-činností ?pocetCinnosti .    
} WHERE {
  ?node l:má-název-agendy ?nazev ; 
    l:má-kód-agendy ?kod .
  FILTER (LANG(?nazev) = "cs")

  {
    SELECT (COUNT(*) AS ?pocetCinnosti)
    WHERE {
      ?cinnost l:je-vykonávána-v-agendě ?node .
    }
  }   
}""" .

<https://martin.necasky.solid.community/profile/kgbrowser/vocabulary/má-počet-činností> a owl:DatatypeProperty ;
  rdfs:label "má počet činností"@cs ;
  rdfs:domain l:agenda ;
  rdfs:range rdfs:Literal .
  
<https://martin.necasky.solid.community/profile/kgbrowser/vocabulary/má-počet-vykonavatelů> a owl:DatatypeProperty ;
  rdfs:label "má počet vykonavatelů"@cs ;
  rdfs:domain l:agenda ;
  rdfs:range rdfs:Literal .
  
l:agenda view:background-color "lightskyblue" ;
  view:border-color "navy" ;
  view:color "black" ;
  view:shape "rectangle" ;
  view:emoji "&#128451;" .
  
l:ohlašuje-agendu view:border-color "lime" ;
  view:color "black" .
  
l:vykonává-agendu view:border-color "tomato" ;
  view:color "black" .
  
l:je-vykonávána-v-agendě view:border-color "orchid" ;
  view:color "black" .    